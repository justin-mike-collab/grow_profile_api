[[source]]
url = "https://pypi.org/simple"
verify_ssl = true
name = "pypi"

[packages]
flask = "*"
pymongo = "*"
pyjwt = "*"
api-utils = {editable = false, git = "https://github.com/agile-learning-institute/mentorhub_api_utils.git", ref = "main"}

[dev-packages]
pytest = "*"
pytest-cov = "*"
black = "*"
setuptools = "*"
build = "*"
twine = "*"
requests = "*"

[scripts]
build = "python -m compileall -b -f -q src/"
dev = "sh -c 'ENABLE_LOGIN=true JWT_SECRET=dev-test PYTHONPATH=. python src/server.py'"
test = "sh -c 'PYTHONPATH=. pytest test/ -v -m \"not e2e\"'"
e2e = "sh -c 'PYTHONPATH=. pytest test/ -m e2e -v'"
coverage = "sh -c 'PYTHONPATH=. pytest test/ -v -m \"not e2e\" --cov=src --cov-report=term-missing --cov-report=html'"
lint = "black --check src test"
format = "black src test"
container = "sh -c 'DOCKER_BUILDKIT=0 docker build --build-arg GITHUB_TOKEN=$GITHUB_TOKEN -t ghcr.io/agile-learning-institute/mentorhub_sample_api:latest .'"
push = "sh -c 'docker push ghcr.io/agile-learning-institute/mentorhub_sample_api:latest'"
build-publish = "sh -c 'pipenv install --dev && pipenv run container && pipenv run push'"
db = "sh -c 'mh down && mh up mongodb'"
api = "sh -c 'mh down && mh up sample_api'"
service = "sh -c 'mh down && mh up sample'"

[requires]
python_version = "3.12"